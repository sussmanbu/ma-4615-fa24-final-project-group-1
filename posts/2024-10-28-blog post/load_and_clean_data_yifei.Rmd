---
title: "test1"
author: "Yifei Zhang"
date: "2024-10-28"
output: html_document
---

```{r}
library(dplyr)
library(lubridate)

# read data
data <- read.csv("C:/Users/wcx15/Documents/car crash test/data/Crash_Reporting_-_Drivers_Data.csv", stringsAsFactors = FALSE)

# remove columns with a high percentage of missing values
threshold <- 0.8
data_clean <- data |> select_if(~mean(is.na(.)) < threshold)

# convert date and time column to datetime format
data_clean$Crash.Date.Time <- mdy_hms(data_clean$Crash.Date.Time)

# convert case number column to character format
data_clean$Local.Case.Number <- as.character(data_clean$Local.Case.Number)

# fill missing values in route type column with the most common value
most_common_route <- data_clean$Route_Type |> 
  na.omit() |>
  table() |> 
  which.max()

data_clean$Route_Type[is.na(data_clean$Route_Type)] <- names(most_common_route)

# remove duplicate rows
data_clean <- data_clean |> distinct()

# check the summary of cleaned data
summary(data_clean)


```
